# 1.STM32 与 ESP01S 温湿度远程监控系统

## 项目简介

本项目是一个基于 STM32F103C8T6 最小核心板与 ESP01S 模块的温湿度远程监控系统，通过 DHT11 温湿度传感器采集环境数据，在本地 0.96 英寸 OLED 显示屏实时显示，同时借助 ESP01S 模块接入机智云平台，实现手机端远程监控功能，让使用者能够随时随地了解目标环境的温湿度状况。

## 系统架构

  * **主控模块** ：STM32F103C8T6 最小核心板，负责整体程序运行与各模块协调控制。
  * **传感器模块** ：DHT11 温湿度传感器，用于采集环境温湿度数据，输出数字信号便于 STM32 读取处理。
  * **显示模块** ：0.96 英寸 OLED 显示屏，与 STM32 连接，用于直观展示当前温湿度数值，方便本地查看。
  * **无线通信模块** ：ESP01S 模块，承担将采集数据通过 Wi-Fi 传输至机智云平台的任务，实现远程监控功能。

## 开发环境

采用 Keil 开发环境进行程序编写与调试，基于标准库开发，充分发挥其稳定、高效的特点，确保代码的兼容性与可靠性。

## 机智云平台接入

  * **设备接入** ：在机智云官网完成设备创建与注册，获取设备唯一标识与密钥，并在 STM32 程序中进行配置，使设备能够成功连接到机智云平台。
  * **数据上传** ：通过 ESP01S 模块，将采集到的温湿度数据按照机智云的通信协议格式进行封装，定时发送到机智云服务器。
  * **手机 APP 监控** ：在手机上安装机智云 APP，通过 APP 连接绑定设备，即可在手机端实时查看温湿度数据变化曲线、历史数据等信息，实现远程监控功能。

## 硬件连接

  * **STM32F103C8T6 与 DHT11 连接** ：DHT11 数据引脚接 STM32 GPIO 引脚，VCC 接 STM32 3.3V，GND 接地。
  * **STM32F103C8T6 与 OLED 连接** ：OLED SDA、SCL 引脚接 STM32 IIC 引脚，VCC 接 3.3V，GND 接地。
  * **STM32F103C8T6 与 ESP01S 连接** ：ESP01S TX 接 STM32 RX，ESP01S RX 接 STM32 TX，ESP01S VCC 经电压转换后接 STM32 3.3V，GND 接地。

## 软件设计

  * **STM32 程序** ：基于标准库编写，实现 DHT11 数据采集、OLED 显示驱动、ESP01S 通信控制等功能。通过定时器定期采集数据，显示在 OLED 上，并通过串口发送给 ESP01S。
  * **ESP01S 配置** ：在 STM32 程序中，通过串口向 ESP01S 发送 AT 指令，完成初始化配置，如设置 Wi-Fi 模式、连接无线路由器、建立与机智云服务器的 TCP/IP 连接等。

## 配置说明

  * **Wi-Fi 参数配置** ：根据实际使用路由器，在代码中修改 ESP01S 连接的 Wi-Fi 名称（SSID）和密码。
  * **机智云参数配置** ：在代码中设置设备在机智云平台的唯一标识、密钥以及服务器地址和端口号等参数。

## 使用说明

  1. 按硬件连接要求连接各模块。
  2. 在 Keil 开发环境下打开项目代码，根据实际引脚连接调整代码定义。
  3. 编译并下载程序到 STM32F103C8T6 最小核心板。
  4. 接通电源，系统运行后，OLED 显示温湿度数据，ESP01S 连接 Wi-Fi 并向机智云平台上传数据。
  5. 手机安装机智云 APP，连接绑定设备，即可远程查看温湿度数据。

## 项目拓展

  * **增加数据处理功能** ：在 STM32 程序中对采集数据进行滤波、平均等处理，提高数据准确性。
  * **实现远程控制功能** ：通过机智云平台向设备发送控制指令，实现对其他设备的远程控制，如控制风扇、空调等设备的开关。
  * **增加数据存储功能** ：使用外部存储芯片将历史数据存储，便于后续查询分析。

## 致谢

感谢开源社区中各位开发者分享的代码和经验，本项目在开发过程中借鉴了一些开源的 STM32 标准库代码、DHT11 和 OLED 的驱动代码以及 ESP01S 的通信示例代码，为项目的顺利完成提供了很大的帮助。同时，感谢机智云平台提供的稳定服务与便捷的开发接口，让本项目能够顺利实现手机端远程监控功能。



# 2.基于 51 单片机的水塔自动抽水系统

## 项目简介

这是一个基于 51 单片机的水塔自动抽水系统，通过 HCSR04 超声波传感器来监测水塔水位，并将控制信息显示在 LCD1602 显示屏上。系统具备自动和手动两种模式，可有效实现水塔水位的智能控制。

## 系统功能

  * **自动模式** ：HCSR04 超声波传感器实时监测水塔水位，当水位低于设定的下限值时，自动启动水泵抽水；当水位达到设定的上限值时，自动停止水泵工作。
  * **手动模式** ：可通过按键手动控制水泵的启动和停止，不受水位限制。
  * **信息显示** ：将当前水位高度、系统模式以及水泵状态等控制信息显示在 LCD1602 显示屏上，方便用户直观了解系统运行情况。

## 硬件连接

  * **单片机部分** ：采用 51 单片机（如 STC89C52）作为核心控制芯片，外接晶振、复位电路等基本外围电路，为系统提供稳定的时钟信号和复位功能。
  * **HCSR04 超声波传感器** ：传感器的 VCC 接单片机 5V 电源，GND 接地，Trig 触发端接单片机 P3.0 引脚，Echo 回波端接单片机 P3.1 引脚。
  * **LCD1602 显示屏** ：LCD1602 的 VCC 和 V0 接电源，RW 接地，RS、E 分别接单片机 P2.0、P2.1 引脚，D0-D7 数据线分别接单片机 P0.0-P0.7 引脚，A 接电位器用于调节显示屏对比度。
  * **按键部分** ：设置两个按键，一个用于模式切换（自动 / 手动），另一个用于手动控制水泵启停（仅在手动模式下有效），按键一端接地，另一端分别接单片机 P3.2、P3.3 引脚，并在按键与电源之间设置上拉电阻。
  * **继电器及水泵** ：继电器线圈一端接单片机 P3.4 引脚，另一端接电源正极，继电器常开触点与水泵电机串联接入市电电路，通过继电器的吸合与断开来控制水泵的工作状态。

## 软件设计

  * **主程序** ：初始化单片机各端口、LCD1602 显示屏、定时器等，设置系统初始状态（自动模式、水泵关闭），然后进入主循环，在主循环中不断读取按键状态，根据按键操作切换系统模式或控制水泵启停（手动模式下），同时调用超声波测距函数获取水位高度，并将相关控制信息发送至 LCD1602 显示屏显示。
  * **HCSR04 超声波测距子程序** ：由单片机向 Trig 端发送至少 10us 的高电平触发信号启动测距，之后 HCSR04 自动发送 8 个 40kHz 的方波并检测回波信号，Echo 端输出高电平持续时间与距离成正比，单片机通过测量该高电平持续时间，利用公式 “距离 =（高电平时间 × 声速（340m/s））/2” 计算出水位高度。
  * **LCD1602 显示子程序** ：编写初始化子程序对 LCD1602 进行屏幕清零、设置显示模式等初始化操作；编写字符显示子程序，将需要显示的字符数据发送至 LCD1602 的数据端，控制其在指定位置显示相应的控制信息，包括水位高度、系统模式（自动 / 手动）、水泵状态（运行 / 停止）等。

## 使用方法

  1. 确保所有硬件连接正确无误，检查电源、晶振、复位电路以及各模块之间的连线是否牢固可靠。
  2. 接通电源，系统上电初始化，LCD1602 显示屏显示系统初始信息，包括 “自动模式”、“水位高度：XXcm”、“水泵：停止” 等内容。
  3. 在自动模式下，系统根据水位自动控制水泵工作，水位低于下限如（ 10cm）时，水泵启动抽水，水位上升；当水位达到上限（如 50cm）时，水泵停止工作。
  4. 如需切换至手动模式，按下模式切换按键，LCD1602 显示屏显示 “手动模式”，此时可通过手动控制按键来启动或停止水泵，水泵工作状态即时显示在屏幕上。
  5. 若要回到自动模式，再次按下模式切换按键即可，系统将恢复自动控制水泵的运行。

## 项目源码

在仓库中，包含了完整的基于 Keil 编写的 C 语言源代码，以及在 Proteus 中搭建的仿真模型文件，方便您进行进一步的学习、测试和修改。
